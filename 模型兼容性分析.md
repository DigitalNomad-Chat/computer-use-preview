# Computer Use Preview 模型兼容性分析报告

## 📋 项目概述

Computer Use Preview 是 Google 开发的一个 AI 驱动的浏览器自动化工具，专门用于通过自然语言指令自动化网页浏览和交互任务。

## 🔒 模型支持限制

### 当前支持的模型

**✅ Gemini 系列模型**
- `gemini-2.5-computer-use-preview-10-2025` (默认模型)
- 其他支持 Computer Use 功能的 Gemini 模型

**✅ Vertex AI 版本**
- 通过环境变量 `USE_VERTEXAI=1` 启用
- 适合企业级部署和私有化需求

### 不支持的模型

**❌ 其他模型 API**
- OpenAI GPT 系列 (GPT-4, GPT-3.5 等)
- Anthropic Claude 系列 (Claude-3, Claude-2 等)
- 开源模型 (Llama, Mistral, Qwen 等)

## 🔧 技术限制分析

### 1. 专用 API 依赖

项目使用 `google-genai` SDK，这是专门为 Google AI 设计的 Python 客户端：

```python
# agent.py:16
from google import genai
from google.genai import types

# agent.py:76-81
self._client = genai.Client(
    api_key=os.environ.get("GEMINI_API_KEY"),
    vertexai=os.environ.get("USE_VERTEXAI", "0").lower() in ["true", "1"],
    project=os.environ.get("VERTEXAI_PROJECT"),
    location=os.environ.get("VERTEXAI_LOCATION"),
)
```

### 2. Gemini 独有的 Computer Use 功能

项目使用了 Gemini 特有的 `computer_use` 工具类型：

```python
# agent.py:109-113
types.Tool(
    computer_use=types.ComputerUse(
        environment=types.Environment.ENVIRONMENT_BROWSER,
        excluded_predefined_functions=excluded_predefined_functions,
    ),
)
```

这个功能是 Google Gemini 独有的，其他模型 API 没有类似的内置浏览器控制能力。

### 3. 预定义函数集

项目依赖 Google 提供的预定义浏览器操作函数：

```python
# agent.py:34-48
PREDEFINED_COMPUTER_USE_FUNCTIONS = [
    "open_web_browser",
    "click_at",
    "hover_at",
    "type_text_at",
    "scroll_document",
    "scroll_at",
    "wait_5_seconds",
    "go_back",
    "go_forward",
    "search",
    "navigate",
    "key_combination",
    "drag_and_drop",
]
```

## 🚀 支持其他模型的技术改造方案

如果要支持其他模型，需要进行以下重大改造：

### 1. 重写 AI 客户端层

```python
# 替换 Google GenAI SDK
# 当前：
from google import genai

# 需要改为：
from openai import OpenAI  # 或其他模型 SDK
```

### 2. 重新实现 Computer Use 功能

由于其他模型没有内置的浏览器控制功能，需要自己实现函数调用机制：

```python
# 当前：Gemini 特有
computer_use=types.ComputerUse(...)

# 需要改为：通用函数调用
tools=[{
    "type": "function",
    "function": {
        "name": "click_at",
        "description": "在指定坐标点击",
        "parameters": {
            "type": "object",
            "properties": {
                "x": {"type": "number"},
                "y": {"type": "number"}
            }
        }
    }
}]
```

### 3. 重构工具调用处理机制

需要重新设计模型响应解析和函数调用执行逻辑，适配不同模型的 API 格式。

## 💡 替代方案对比

### 1. Computer Use Preview (当前项目)

**优势：**
- ✅ Gemini 原生 Computer Use 支持
- ✅ 预定义浏览器操作函数
- ✅ 一键自动化执行
- ✅ Google 官方维护

**劣势：**
- ❌ 仅支持 Gemini 模型
- ❌ 模型选择受限
- ❌ 依赖 Google API 服务

### 2. Claude Code + Playwright MCP

**优势：**
- ✅ 支持多种模型 (Claude, GPT 等)
- ✅ 架构灵活可扩展
- ✅ 实时交互控制
- ✅ 无需额外 API 配置
- ✅ 与开发环境深度集成

**劣势：**
- ❌ 需要手动指导每步操作
- ❌ 自动化程度较低

### 3. 自研多模型浏览器自动化

**优势：**
- ✅ 完全自主控制
- ✅ 支持任意模型
- ✅ 可定制化程度高

**劣势：**
- ❌ 开发工作量大
- ❌ 需要处理多种 API 差异
- ❌ 维护成本高

## 🎯 推荐方案

### 对于不同使用场景：

1. **如果您主要使用 Google 生态**：
   - 继续使用 Computer Use Preview
   - 利用 Gemini 原生 Computer Use 功能

2. **如果您需要多模型支持**：
   - 使用 Claude Code + Playwright MCP
   - 这是当前最佳的替代方案

3. **如果您有特殊需求**：
   - 基于此项目进行改造
   - 保留浏览器控制逻辑，替换 AI 客户端

## 📝 总结

Computer Use Preview 是一个优秀的浏览器自动化项目，但其模型兼容性受限于 Google Gemini 的特有功能。在选择使用方案时，需要根据具体需求权衡：

- **模型灵活性** → 选择 Claude Code + Playwright MCP
- **自动化程度** → 选择 Computer Use Preview
- **定制化需求** → 考虑自研或改造现有项目

每种方案都有其适用的场景，关键是根据实际需求做出合适的选择。

---

*文档创建时间：2025-12-08*
*基于 computer-use-preview 项目的代码分析*